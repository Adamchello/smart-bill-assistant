---
import { createSupabaseServerClient } from "@/kernel/db/supabase-server"
import MainLayout from "../layouts/main.astro"
import { RegisterShell } from "@/shells/register/shell"
import { AppRouter } from "@/kernel/routing/app-router"

const supabase = createSupabaseServerClient({
  request: Astro.request,
  cookies: Astro.cookies,
})

const {
  data: { user },
} = await supabase.auth.getUser()

if (user) {
  return Astro.redirect(AppRouter.getPath("dashboard"))
}
---

<MainLayout title="Register">
  <RegisterShell client:load />
</MainLayout>
